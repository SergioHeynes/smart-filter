<div class="mb-10">
    <!-- <p>
        CONFIG: 
        {{config | json}}
    </p> -->
    
    <!-- <p>
        FORM: 
        {{filterForm.value | json}}
    </p> -->
    
    
    <p>
        FILTERS:
        {{filters.value | json}}
    </p>
    
    <!-- <p>
        FILTER SELECTED CONTROL:
        {{filterOptionsMenu.value | json}}
    </p> -->
</div>


<div>

    <div [formGroup]="filterForm">

        <ng-container formArrayName="filters">

            <ng-container *ngFor="let filterControl of filters.controls; let i = index">
                <div class="flex gap-4" [formGroupName]="i">
                
                    <!-- <mat-form-field appearance="fill">
                        <input matInput formControlName="displayName" placeholder="filter displayName">
                    </mat-form-field> -->

                    <label for="">Nombre: </label>

                    <mat-form-field>
                        <mat-select [formControl]="filterOptionsMenu" (selectionChange)="filterOptionsChange($event.value, i)">
                          <mat-option *ngFor="let field of config.fields" [value]="field">
                            {{field.displayName}}
                          </mat-option>
                        </mat-select>
                      </mat-form-field>

                      <!-- <mat-form-field>
                        <mat-select [formControl]="filterOptionsMenu" (selectionChange)="filterOptionsChange($event.value, i)">
                          <mat-option value="Elemento 1">
                            Elemento 1
                          </mat-option>
                          <mat-option value="Elemento 2">
                            Elemento 2
                          </mat-option>
                          <mat-option value="Elemento 3">
                            Elemento 3
                          </mat-option>
                        </mat-select>
                      </mat-form-field> -->

                      <mat-form-field>
                        <mat-select formControlName="filterOperator">
                          <mat-option *ngFor="let option of filterControl.get('queryOptions')?.value" [value]="option">
                            {{option}}
                          </mat-option>
                        </mat-select>
                      </mat-form-field>

                      <!-- {{filterControl.get('queryOptions')?.value | json}} -->

                      <mat-form-field *ngIf="filterControl.get('filterOperator')?.value === 'entre'">
                        <mat-label>Enter a date range</mat-label>
                        <mat-date-range-input [formGroup]="range" [rangePicker]="picker">
                          <input matStartDate formControlName="start" placeholder="Start date" (dateInput)="setDates(i, 'start')">
                          <input matEndDate formControlName="end" placeholder="End date" (dateInput)="setDates(i, 'end')">
                        </mat-date-range-input>
                        <mat-hint>MM/DD/YYYY – MM/DD/YYYY</mat-hint>
                        <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
                        <mat-date-range-picker #picker></mat-date-range-picker>
                      </mat-form-field>

                    <mat-form-field appearance="fill" *ngIf="filterControl.get('filterOperator')?.value !== 'entre'">
                        <input #elInput matInput formControlName="value" placeholder="filter values" (keyup.enter)="setValue(i)">
                    </mat-form-field>

<!-- 
                    
                        <mat-select placeholder="Elige una opción">
                            <mat-option [value]="option._id" *ngFor="let option of config.filterOptionsMenu">{{option.displayName}}</mat-option>
                        </mat-select> -->

                        
                    <mat-icon class="delete-btn" (click)="deleteFilter(i)">
                        delete_forever</mat-icon>
                </div>
            </ng-container>
        </ng-container>

    </div>

    <button [type]="'button'" (click)="addFilter()">+ Agregar filtro</button>
</div>

<div>

</div>